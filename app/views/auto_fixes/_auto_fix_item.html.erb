<div class="auto-fix-item border border-gray-700 rounded-lg bg-gray-900/50 transition-all overflow-hidden"
     data-projects-target="autoFixItem"
     data-auto-fix-id="<%= auto_fix.id %>">

  <!-- Collapsed State: Button -->
  <button type="button"
          class="w-full text-left p-3 hover:bg-gray-800 transition-all group flex items-center justify-between"
          data-action="click->projects#toggleAutoFix"
          data-projects-target="autoFixHeader">
    <div class="text-sm font-medium text-white group-hover:text-blue-400 transition-colors"><%= auto_fix.title %></div>
    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"
         class="w-4 h-4 text-gray-500 transform transition-transform duration-200"
         data-projects-target="autoFixChevron">
      <path stroke-linecap="round" stroke-linejoin="round" d="m19.5 8.25-7.5 7.5-7.5-7.5" />
    </svg>
  </button>

  <!-- Expanded State: Content -->
  <div class="hidden border-t border-gray-700 p-4 space-y-4 bg-gray-800/30"
       data-projects-target="autoFixContent">
    <div>
      <label class="block text-[10px] font-bold uppercase text-gray-500 tracking-wider mb-2">Refine Fix Description</label>
      <textarea class="w-full h-24 bg-gray-700 border border-gray-600 rounded-lg p-3 text-sm text-white placeholder-gray-400 focus:ring-blue-500 focus:border-blue-500 resize-none"
                data-projects-target="autoFixDescriptionInput"><%= auto_fix.description %></textarea>
    </div>

    <!-- Variations Section -->
    <div class="space-y-4">
      <%= render "projects/tools/variations_controls" %>

      <button class="w-full bg-blue-600 hover:bg-blue-500 text-white font-bold py-3 rounded-lg shadow-lg shadow-blue-900/50 transition-all flex items-center justify-center gap-2"
              data-action="click->projects#performAutoFix"
              data-auto-fix-id="<%= auto_fix.id %>"
              data-auto-fix-title="<%= auto_fix.title %>">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-4 h-4">
          <path stroke-linecap="round" stroke-linejoin="round" d="M9.813 15.904 9 18.75l-.813-2.846a4.5 4.5 0 0 0-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 0 0 3.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 0 0 3.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 0 0-3.09 3.09ZM18.259 8.715 18 9.75l-.259-1.035a3.375 3.375 0 0 0-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 0 0 2.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 0 0 2.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 0 0-2.456 2.456ZM16.894 20.567 16.5 21.75l-.394-1.183a2.25 2.25 0 0 0-1.423-1.423L13.5 18.75l1.183-.394a2.25 2.25 0 0 0 1.423-1.423l.394-1.183.394 1.183a2.25 2.25 0 0 0 1.423 1.423l1.183.394-1.183.394a2.25 2.25 0 0 0-1.423 1.423Z" />
        </svg>
        Generate Fix
      </button>
    </div>
  </div>
</div>
