<%= link_to admin_chapter_path(chapter), class: "block group", id: dom_id(chapter) do %>
  <div class="bg-white overflow-hidden shadow rounded-lg hover:shadow-md transition-shadow duration-200 border border-gray-200">
    <div class="relative h-48 bg-gray-200">
      <% if chapter.video.attached? %>
        <video class="w-full h-full object-cover">
          <source src="<%= rails_blob_url(chapter.video) %>" type="video/mp4">
        </video>
        <div class="absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-10 transition-opacity flex items-center justify-center">
          <svg class="h-12 w-12 text-white opacity-0 group-hover:opacity-100 transition-opacity drop-shadow-lg" fill="currentColor" viewBox="0 0 20 20">
            <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z" clip-rule="evenodd" />
          </svg>
        </div>
      <% else %>
        <div class="w-full h-full flex items-center justify-center bg-gray-100 text-gray-400">
          <svg class="h-12 w-12" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z" />
          </svg>
        </div>
      <% end %>

      <div class="absolute top-2 right-2">
        <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium <%= chapter.completed? ? 'bg-green-100 text-green-800' : (chapter.failed? ? 'bg-red-100 text-red-800' : 'bg-yellow-100 text-yellow-800') %> shadow-sm">
          <%= chapter.progress.humanize %>
        </span>
      </div>
    </div>

    <div class="px-4 py-4">
      <div class="flex justify-between items-start">
        <h3 class="text-lg font-medium text-gray-900 group-hover:text-indigo-600 transition-colors truncate w-full" title="<%= chapter.title %>">
          <%= chapter.title %>
        </h3>
      </div>

      <div class="mt-2 flex items-center text-sm text-gray-500">
        <svg class="flex-shrink-0 mr-1.5 h-4 w-4 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
        </svg>
        <%= time_ago_in_words(chapter.created_at) %> ago
      </div>

      <% unless chapter.completed? || chapter.failed? || chapter.pending? %>
        <div class="mt-4">
          <div class="flex justify-between text-xs text-gray-500 mb-1">
            <span><%= chapter.progress.humanize %>...</span>
            <span><%= chapter.progress_before_type_cast %>%</span>
          </div>
          <div class="w-full bg-gray-200 rounded-full h-2">
            <div class="bg-indigo-600 h-2 rounded-full transition-all duration-500" style="width: <%= chapter.progress_before_type_cast %>%"></div>
          </div>
        </div>
      <% end %>

      <div class="mt-4 flex items-center justify-between">
        <span class="inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-gray-100 text-gray-800">
          <%= chapter.video_mode.capitalize %>
        </span>
        <span class="text-sm font-medium text-indigo-600 group-hover:text-indigo-500">
          View Details &rarr;
        </span>
      </div>
    </div>
  </div>
<% end %>
