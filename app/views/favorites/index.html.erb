<% content_for :title, "My Favorite Designs | Saved Garden Ideas - Hadaa" %>
<% content_for :description, "Access your favorite AI-generated garden and landscape designs. Keep track of inspiring designs you love and revisit them anytime for your landscaping projects." %>

<div class="max-w-4xl mx-auto p-4 md:p-8">
  <h1 class="text-3xl font-bold text-accent mb-6">ðŸ’– My Favorites</h1>

  <% if @favorites.any? %>
    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
      <% @favorites.each do |favorite| %>
        <% favoritable = favorite.favoritable %>

        <% if favoritable %>
          <%# Render the correct partial based on the class of the favorited object %>
          <%= render partial: "favorites/#{favoritable.model_name.param_key}_preview",
                     locals: { favoritable: favoritable, favorite: favorite } %>
        <% else %>
          <%# Handles cases where the original record (text_request or mask_request) was deleted %>
          <div class="bg-neutral-700 p-4 rounded-lg shadow-md text-neutral-400">
            Original item not found (ID:
            <%= favorite.favoritable_id %>
            ).
            <%= button_to favorite, method: :delete, data: { confirm: 'Remove this broken favorite?' }, class: "text-red-400 hover:text-red-300 mt-2" do %>
              Remove
            <% end %>
          </div>
        <% end %>
      <% end %>
    </div>
  <% else %>
    <div class="text-center p-12 bg-neutral-800 rounded-lg shadow-lg">
      <p class="text-xl text-neutral-400">
        You haven't favorited any creations yet!
      </p>

      <p class="text-neutral-500 mt-2">
        Go generate some beautiful landscapes!
      </p>

      <%= link_to "Go to Canva", new_canva_path, class: "cute-btn accent-btn mt-4" %>
    </div>
  <% end %>
</div>
