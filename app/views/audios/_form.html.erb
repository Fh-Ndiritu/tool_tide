<%= form_with(model: audio, class: "space-y-6 w-full p-6 sm:p-10 bg-white shadow-2xl hover:shadow-xl transition-shadow duration-300 rounded-xl border border-neutral-300") do |form| %>
  <!-- Heading uses --color-text-dark (text-neutral-900) -->
  <h1 class="text-3xl font-extrabold text-neutral-900 mb-6 border-b pb-3">Audio Generation Request</h1>

  <% if audio.errors.any? %>
    <div id="error_explanation" class="bg-red-50 border-l-4 border-red-500 text-red-700 p-4 rounded-md">
      <h2 class="font-bold text-lg mb-1">There were <%= pluralize(audio.errors.count, "error") %>:</h2>
      <ul class="list-disc ml-6 text-sm space-y-0.5">
        <% audio.errors.each do |error| %>
          <li><%= error.full_message %></li>
        <% end %>
      </ul>
    </div>
  <% end %>

  <!-- Single Speaker/Multi-Speaker Mode Selection -->
  <div class="flex flex-col">
    <!-- Label uses a custom neutral color -->
    <%= form.label :single_speaker, "Generation Mode", class: "block text-sm font-semibold text-neutral-700 mb-2" %>

    <!-- Background uses light neutral color, border uses medium neutral color -->
    <div class="flex flex-col sm:flex-row gap-4 p-4 bg-neutral-100 rounded-lg border border-neutral-300">
      <label class="flex items-center space-x-2 cursor-pointer p-2 flex-1 bg-white rounded-lg shadow-sm hover:bg-accent-secondary transition duration-150">
        <!-- Radio buttons use --color-primary for text/focus rings -->
        <%= form.radio_button :single_speaker, true, class: "focus:ring-primary h-5 w-5 text-primary border-neutral-300", checked: audio.single_speaker.nil? ? true : audio.single_speaker %>
        <span class="text-sm font-medium text-neutral-800">Single Speaker (Plain Text)</span>
      </label>

      <label class="flex items-center space-x-2 cursor-pointer p-2 flex-1 bg-white rounded-lg shadow-sm hover:bg-accent-secondary transition duration-150">
        <!-- Radio buttons use --color-primary for text/focus rings -->
        <%= form.radio_button :single_speaker, false, class: "focus:ring-primary h-5 w-5 text-primary border-neutral-300" %>
        <span class="text-sm font-medium text-neutral-800">Multi-Speaker (JSON Conversation)</span>
      </label>
    </div>
  </div>

  <!-- Content Input (Text Area for better multi-line input) -->
  <div class="flex flex-col">
    <%= form.label :content, "Content (Text or JSON)", class: "block text-sm font-semibold text-neutral-700 mb-2" %>
    <%= form.text_area :content, rows: 8, placeholder: "For Single Speaker: Enter plain text here.\n\nFor Multi-Speaker: Enter a JSON array of turns, e.g.:\n[{\"speaker\": \"default\", \"text\": \"Hello Joe\"}, {\"speaker\": \"secondary\", \"text\": \"Hello Jane\"}]",
      class: ["block w-full rounded-lg border shadow-sm px-4 py-3 text-base resize-none placeholder-neutral-500",
        # Focus/Error States using theme colors
        {"border-neutral-300 focus:ring-primary focus:border-primary": audio.errors[:content].none?,
         "border-red-400 focus:ring-red-500 focus:border-red-500": audio.errors[:content].any?}] %>
  </div>

  <!-- Style Prompt Input -->
  <div class="flex flex-col">
    <%= form.label :style_prompt, "Style Prompt (Optional)", class: "block text-sm font-semibold text-neutral-700 mb-2" %>
    <%= form.text_field :style_prompt, placeholder: "e.g., 'Say this in a cheerful, energetic voice' or 'Speak as two knowledgeable colleagues'",
      class: ["block w-full rounded-lg border shadow-sm px-4 py-3 text-base placeholder-neutral-500",
        # Focus/Error States using theme colors
        {"border-neutral-300 focus:ring-primary focus:border-primary": audio.errors[:style_prompt].none?,
         "border-red-400 focus:ring-red-500 focus:border-red-500": audio.errors[:style_prompt].any?}] %>
  </div>

  <!-- Submit Button -->
  <div class="pt-4">
    <!-- Submit button uses --color-cta-bg and --color-text-light -->
    <%= form.submit "Generate Audio", class: "w-full rounded-lg px-6 py-3 bg-cta-bg hover:bg-primary text-text-light text-lg font-bold shadow-lg transition duration-200 ease-in-out cursor-pointer hover:shadow-xl focus:outline-none focus:ring-4 focus:ring-primary focus:ring-opacity-50" %>
  </div>
<% end %>
