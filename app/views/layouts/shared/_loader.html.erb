<div id="loader" class="z-[2147483647]">
  <% is_fullscreen = klasses.include?('fixed') %>

  <div
    data-loader-target="loader"
    class="<%= klasses %> inset-0 flex flex-col items-center justify-center z-[2147483647] transition-all duration-500 <%= is_fullscreen ? 'bg-gray-900/90 backdrop-blur-md' : 'bg-black opacity-85' %>"
  >
    <% if is_fullscreen %>
      <!-- Fullscreen Loader Design -->
      <div class="relative flex flex-col items-center">
        <!-- Pulsing Logo -->
        <div class="relative mb-8">
          <div
            class="
              absolute inset-0 bg-secondary/30 rounded-full blur-2xl
              animate-pulse
            "
          ></div>
          <%= image_tag "hadaa.png", class: "relative w-24 h-24 md:w-32 md:h-32 object-contain animate-bounce", style: "animation-duration: 2s;", alt: "Hadaa AI Landscape Design Generator Loading" %>
        </div>

        <!-- Loading Spinner -->
        <div class="relative mb-6">
          <div
            class="
              w-16 h-16 border-4 border-gray-700 border-t-secondary
              rounded-full animate-spin
            "
          ></div>
        </div>

        <!-- Text Content -->
        <div class="text-center space-y-3 max-w-md px-4">
          <h3
            class="
              text-2xl md:text-3xl font-bold text-white tracking-tight
              animate-pulse
            "
          >
            Designing your garden...
          </h3>
          <p
            class="text-lg text-gray-300 font-medium"
            data-loader-target="processingMessage"
          >
            <%= progress_message(record.try(:progress)) %>
          </p>
        </div>
      </div>
    <% else %>
      <!-- Minimal Embed Loader Design -->
      <div
        class="
          inline-block h-12 w-12 group-[&.embed]:h-6 group-[&.embed]:w-6
          animate-spin rounded-full border-4 border-solid border-current
          border-e-transparent text-white
        "
        role="status"
      ></div>
      <p
        class="text-xl group-[&.embed]:text-sm text-white mt-4"
        data-loader-target="processingMessage"
      >
        <%= progress_message(record.try(:progress)) %>
      </p>
    <% end %>
  </div>
</div>
