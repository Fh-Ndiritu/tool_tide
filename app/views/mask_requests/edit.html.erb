<% content_for :title, "Select Your Garden Style | AI Landscape Design - Hadaa" %>

<% content_for :description, "Choose from curated garden design styles for your landscape. Browse modern, traditional, zen, cottage, and more styles to transform your outdoor space with AI-powered design." %>

<%= turbo_stream_from @mask_request.canva %>

<div
  class="flex w-full flex-col items-center min-h-screen p-2"
  id="styles"
>
  <div class="w-full sm:max-w-lg lg:max-w-5xl">
    <div class="bg-white/10 backdrop-blur-xl border border-white/20 p-3 sm:p-4 rounded-3xl shadow-2xl my-8">

      <%= render 'shared/balances' %>
      <!-- Title Section -->
      <div class="mb-8 flex flex-col w-full items-center text-center">
        <h3 class="text-3xl font-extrabold text-white mb-2">
          Select your style
        </h3>
        <p class="text-lg text-neutral-300">You can change this later.</p>
      </div>

      <!-- Presets Grid -->
      <div class="mb-8">
        <!-- Grid container for all presets -->
        <div
          class="
            grid grid-cols-2 gap-3 md:gap-12 sm:grid-cols-2 lg:grid-cols-3
            2xl:grid-cols-3
          "
        >
          <% LANDSCAPE_PRESETS.each do |preset, description| %>
            <% is_preferred = PRESETS_WITH_PREFERENCES.include?(preset) %>
            <% # Base classes shared by all cards %>
            <% base_classes = "relative block max-sm:mb-4 p-2 md:p-4 rounded-xl shadow-lg hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1 cursor-pointer border-2" %>

            <% # Conditional coloring classes %>
            <% color_classes = if is_preferred
                 if @mask_request.preset == preset
                   'bg-purple-500/20 border-purple-400 ring-2 ring-purple-400/20'
                 else
                   'bg-purple-500/10 border-purple-500/30 hover:bg-purple-500/20 hover:border-purple-400/50'
                 end
               else
                 if @mask_request.preset == preset
                   'bg-white/10 border-[#00acc1] ring-2 ring-[#00acc1]/20'
                 else
                   'bg-white/5 border-transparent hover:border-white/20 hover:bg-white/15'
                 end
               end %>

            <!-- Link for each preset, styled as a card -->
            <%= button_to mask_request_path(@mask_request, mask_request: {preset: preset}), method: :patch,
                id: "#{preset.downcase}_preset",
                class: "#{base_classes} #{color_classes}" do %>

              <% if is_preferred %>
                <!-- AI Badge -->
                <div class="absolute top-2 right-2 bg-purple-500 text-white text-[10px] font-bold px-2 py-0.5 rounded-full flex items-center gap-1 shadow-lg z-10">
                  <svg xmlns="http://www.w3.org/2000/svg" class="w-3 h-3" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275Z"/>
                  </svg>
                </div>
              <% end %>

              <div class="flex flex-col items-center text-center">
                <%= image_tag("presets/#{preset}.png", class: "w-full h-auto object-contain rounded-lg mb-4") %>
                <div class="font-semibold text-lg text-white mb-1">
                  <%= preset.humanize %>
                </div>

                <div class="text-sm text-neutral-300"><%= description %></div>

                <% if is_preferred %>
                  <div class="text-xs text-purple-200 mt-2 font-medium bg-purple-500/20 px-2 py-1 rounded-lg">
                    Supports location & preferences
                  </div>
                <% end %>
              </div>
            <% end %>
          <% end %>
        </div>
      </div>
    </div>
  </div>
</div>
